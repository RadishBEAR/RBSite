name: CI
on:
  # è§¦å‘æŒç»­é›†æˆçš„gitæ“ä½œ
  push:
    branches:
      # è§¦å‘æŒç»­é›†æˆå’ŒæŒç»­éƒ¨ç½²çš„åˆ†æ”¯
      - main

jobs:
  main:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout
      uses: actions/checkout@v2
      with:
        persist-credentials: false

    # å®‰è£…ä¾èµ–ä¸ç¼–è¯‘
    - name: Install and Build
      run: |
        npm install
        npm run build
     
    # éƒ¨ç½² 
    - name: Deploy to github page
      # ä½¿ç”¨å·²æœ‰çš„éƒ¨ç½²è„šæœ¬æ¥è¿›è¡Œäº§ç‰©éƒ¨ç½²
      uses: JamesIves/github-pages-deploy-action@releases/v3
      with:
        ACCESS_TOKEN: ${{ secrets.ACTION_TOKEN }}
        BRANCH: gh-pages
        # FOLDERä¸ºéœ€è¦è¿›è¡Œéƒ¨ç½²çš„æ–‡ä»¶å¤¹åï¼Œå³dist
        FOLDER: dist
    - name: ğŸ“‚ Sync files
      uses: SamKirkland/FTP-Deploy-Action@4.0.0
      with:
        server: ${{ secrets.FTP_SERVER }}
        username: ${{ secrets.FTP_USERNAME }}
        password: ${{ secrets.FTP_PASSWORD }}
        local-dir: ./dist/
